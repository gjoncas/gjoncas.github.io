<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="https://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <!-- 
      loads the http over https ssl - 
      welcome to my website! 

	this theme is based off the Ice & Fire theme created by Lucas Gatsas
      https://www.twitter.com/LucasGatsas
      www.lucasgatsas.ch - switzerland. 
                                                    -->

    <!--
<script type="text/javascript">
var host = "https://gjoncas.github.io";
if ((host == window.location.host) && (window.location.protocol != "https:"))
    window.location.protocol = "https";
</script>
-->
    <!-- Microsoft Internet Explorer documentMode compatMode setting IE Modus -->
    <script type="text/javascript">
        var IE = null;
        if (window.navigator.appName == "Microsoft Internet Explorer") {
            if (document.documentMode) {

                IE = document.documentMode;
            } else {

                IE = 5;
                if (document.compatMode) {
                    if (document.compatMode == "CSS1Compat")
                        IE = 11;
                }
            }
        }
    </script>

    <meta charset="utf-8">
    <!-- X-UA -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="X-UA-Compatible" content="IE=11" />


    <meta name="google" content="notranslate" />
    <!-- Viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- index ROBOTS follow -->
    <meta name="robots" content="index, follow" />
    <!-- Site Desciption -->
    
    <meta name="description" content="We are a way for capital to know itself">
    

    <meta name="keywords" content="Graham Joncas, gjoncas, philosophy of economics, computational economics">
    <!-- Favicon -->
    <link rel="shortcut icon" href="https://gjoncas.github.io/static/img/ico.png" type="image/x-icon" />
    <!-- Blog Title -->
    
    <title>Oneironomics | The Associativity Law for Monads</title>
    
    <!--     <title>{% if page.title %}{{ page.title }} - {{ site.title }}{% else %}{{ site.title }}{% endif %}</title>
-->
    <!-- Property Metas -->
    <meta property="og:image" content="https://gjoncas.github.io/static/img/ix.png" />  <!-- what image is this?-->
    
    <meta property="og:title" content="We are a way for capital to know itself" />
    <meta property="og:site_name" content="We are a way for capital to know itself" />
    
    <!-- Canonical -->
    <link rel="canonical" href="{{ page.url | replace:'index.html','' | prepend: site.baseurl | prepend: site.url }}">
    <!-- StyleSheet -->
    <link rel="stylesheet" href="https://gjoncas.github.io/static/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://gjoncas.github.io/static/css/spaceg.stylesheets.css">
    <link rel="stylesheet" href="https://gjoncas.github.io/static/css/syntax.css">
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Merriweather:400,300,300italic,400italic,700,700italic,900,900italic" rel="stylesheet" type="text/css">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Playfair+Display:400,700,900,400italic,700italic,900italic" rel="stylesheet" type="text/css">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <style>
        #preloader {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #000;
            /* change if the mask should have another color then white */
            z-index: 99;
            /* makes sure it stays on top */
        }

        #status {
            width: 200px;
            height: 200px;
            position: absolute;
            left: 50%;
            /* centers the loading animation horizontally on the screen */
            top: 50%;
            /* centers the loading animation vertically on the screen */
            background-image: url("/static/img/preloader.gif");
            /* path to your loading animation */
            background-repeat: no-repeat;
            background-position: center;
            margin: -100px 0 0 -100px;
            /* is width and height divided by two */
        }

        ul,
        ol {
            margin-top: 0;
            margin-bottom: 10px;
        }

        .navbar-inverse {
            background-color: #000;
            border-color: #000000;
        }
    </style>
    <!--link rel="stylesheet" href="https://gjoncas.github.io/static/css/prettify.css"-->
    <style>
        header.intro-header {
            background: #6f5499;
            background: no-repeat center center;
            background-attachment: scroll;
            -webkit-background-size: cover;
            -moz-background-size: cover;
            background-size: cover;
            -o-background-size: cover;
        }

        /* Preloader */
        #preloader {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #000;
            /* change if the mask should have another color then white */
            z-index: 99;
            /* makes sure it stays on top */
        }

        #status {
            width: 200px;
            height: 200px;
            position: absolute;
            left: 50%;
            /* centers the loading animation horizontally one the screen */
            top: 50%;
            /* centers the loading animation vertically one the screen */
            background-image: ;
            /* path to your loading animation */
            background-repeat: no-repeat;
            background-position: center;
            margin: -100px 0 0 -100px;
            /* is width and height divided by two */
        }

        li {
            list-style: none;
        }

        body.modal-open {
            overflow: hidden;
            padding-right: 0px;
        }

        article li {
            list-style: inherit;
        }

        article .figure {
            text-align: center
        }
    </style>
    <!-- end Loading front stylesheet here -->
</head>

    

<body>
    <!--<div id="preloader">
        <div id="status">

        </div>
    </div>-->
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://gjoncas.github.io" id="blog-title-left-top"><span style="color:gray"><span style="font-family:candara;">oneironomics</span></span></a>
        </div>
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li class="dropdown">
                    <a href="#portfolioModal2" data-toggle="modal"><i class="fa fa-random" id="icon-top"></i></a>
                    <ul class="dropdown-menu"></ul>
                </li>
                <li><!-- <a href="https://instagram.com/tesseractics/" target="_blank"><i class="fa fa-instagram" id="icon-top"></i></a>--></li>
                <li><!-- <a href="https://linkedin.com/in/graham-joncas/" target="_blank"><i class="fa fa-linkedin" id="icon-top"></i></a>--></li>
                <li><a href="https://gjoncas.github.io/About.html" target="_blank">About</a></li>
                <li><a href="https://gjoncas.github.io/Research.html" target="_blank">Research</a></li>
				<li><a href="https://gjoncas.github.io/Projects.html" target="_blank">Projects</a></li>

                <li><a href="https://gjoncas.github.io/blog.html">Blog</a></li>
                
                <li><a href="https://www.twitter.com/gjncs" id="roundbutton" target="_blank"><i class="fa fa-twitter"></i>gjncs</a></li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<!-- Portfolio Modals -->
<div class="portfolio-modal modal fade" id="portfolioModal1" tabindex="-1" role="dialog" aria-hidden="true" style="padding-right:0px; overflow: hidden;">
    <div class="modal-content">
        <div class="close-modal" data-dismiss="modal">
            <div class="lr">
                <div class="rl">
                </div>
            </div>
        </div>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2">
                    <div class="modal-body">
                        <h1 class="font-style-inline-small-h1">Graham Joncas</h1>
                        <hr class="star-primary">
                        <img src="https://github.com/gjoncas/Artsy-Diagrams/raw/master/pics/metatron.png" class="img-responsive img-centered" alt title>
                        <p class="font-style-inline-small">
                            I live in Canada, and do research on computational economics and formal philosophy. <br>
                            This is my personal website and blog. The best way to contact me is via <a href="https://www.twitter.com/gjncs" target="_blank">Twitter</a>.<br>
                            <a href="https://www.github.com/gjoncas" target="_blank"> <i class="fa fa-github" id="spaceg-social-modal"></i> </a>
                            <a href="https://www.twitter.com/gjncs" target="_blank"><i class="fa fa-twitter" id="spaceg-social-modal"></i> </a>
                            <a href="https://www.instagram.com/tesseractics" target="_blank"><i class="fa fa-instagram" id="spaceg-social-modal"></i> </a>
                            <a href="https://www.linkedin.com/in/graham-joncas" target="_blank"><i class="fa fa-linkedin" id="spaceg-social-modal"></i> </a>
                        </p>
                        <button type="button" class="btn btn-default" data-dismiss="modal"><i class="fa fa-times"></i> Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Menu Modals Add New Sa.21.Feb.2015 03:22:25 -->
<div class="portfolio-modal modal fade" id="portfolioModal2" tabindex="-1" role="dialog" aria-hidden="true" style="padding-right:0px; overflow: hidden;">
    <div class="modal-content">
        <div class="close-modal" data-dismiss="modal">
            <div class="lr">
                <div class="rl">
                </div>
            </div>
        </div>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2">
                    <div class="modal-body">
                        <h1 class="font-style-inline-small-h1">oneironomics</h1>
                        <hr class="star-primary">
                        <p class="font-style-inline-small">
                            Computational economics <br>
							Conceptual engineering <br>
							Surrationalism <br>
                            
                            <a href="https://www.github.com/gjoncas" target="_blank">
                                <i class="fa fa-github" id="spaceg-social-modal"></i>
                            </a>
                            
                            
                            <a href="https://www.twitter.com/gjncs" target="_blank">
                                <i class="fa fa-twitter" id="spaceg-social-modal"></i>
                            </a>
                            
                            
                            <a href="https://www.instagram.com/tesseractics" target="_blank">
                                <i class="fa fa-instagram" id="spaceg-social-modal"></i>
                            </a>
                            
                            
                            <a href="https://www.linkedin.com/in/graham-joncas" target="_blank">
                                <i class="fa fa-linkedin" id="spaceg-social-modal"></i>
                            </a>
                            
                            <li><a href="https://gjoncas.github.io/">Home</a></li>
                            <li><a href="https://gjoncas.github.io/Research.html">Research</a></li>
							<li><a href="https://gjoncas.github.io/Projects.html">Projects</a></li>
                            <li><a href="https://gjoncas.github.io/blog.html">Blog</a></li>
                        </p>

                        <button type="button" class="btn btn-default" data-dismiss="modal"><i class="fa fa-times"></i> Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

    <div id="content" align="justify">
        <!-- Post Header -->
<header class="intro-header" style="background-image: url('https://gjoncas.github.io/static/img/tasvicze.jpg')" alt title>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1><span style="color:white">The Associativity Law for Monads</span></h1>
                    
                    <span class="meta" style="color:white">
                        
                        May 30, 2020
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1" align="justify">

                <p>During quarantine, I’ve been pursuing a goal I’ve had for years: to grok monads. In a word, monads are the <a href="https://en.wikipedia.org/wiki/Pons_asinorum">pons asinorum</a> of functional programming: once you get them, you’re part of the ‘club’.</p>
<p>A pithy <a href="https://stackoverflow.com/questions/17590842">definition</a> I’ve found is that monads are a “type for output impurity”. Even from this we can see how much the concept is tied to the functional programming paradigm, and makes little sense outside of it. Within that paradigm, however, monads are a deeply elegant solution to a variety of problems, and continually give new ‘aha’ moments as one progresses deeper and deeper.</p>
<p>This post documents one such moment — a tiny one, but one that tripped me up for quite a while. To follow along, the reader should have read and understood the <a href="https://en.wikibooks.org/wiki/Haskell/Understanding_monads">Haskell wikibook</a> page on monads.</p>
<hr />
<p>Associativity means it doesn’t matter what order we evaluate a statement, typically written as:</p>
<p><code>(a ∘ b) ∘ c = a ∘ (b ∘ c)</code></p>
<p>However, in Haskell the associativity law is written as follows:</p>
<p><code>(𝑚 &gt;&gt;= f) &gt;&gt;= g  =  𝑚 &gt;&gt;= (\x -&gt; f x &gt;&gt;= g)</code></p>
<p>Yeesh. It’s not at all obvious that these are the same. For this reason, many people prefer the Kleisli composition operator (or ‘fish’), which lets us write the above as:</p>
<p><code>(f &gt;=&gt; g) &gt;=&gt; h  =  f &gt;=&gt; (g &gt;=&gt; h)</code></p>
<p>This gives us the structure we want, but just hides the whole problem within the definition of &gt;=&gt;, which is just as hairy, namely: <code>f &gt;=&gt; g = \x -&gt; f x &gt;&gt;= g</code>. Gag me with a spoon.</p>
<p>Here I want to explain my Eureka moment in finally getting the associativity law for bind.</p>
<hr />
<p>First, note that the type signature for bind (&gt;&gt;=) is as follows:</p>
<p><code>(&gt;&gt;=) :: Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b</code></p>
<p>So when used as an infix, the left-hand argument must be a monadic object, while the right-hand argument must be a function that takes a non-monadic object, and makes it into a monadic object. (Note that 𝑚 is not the same as m.)</p>
<p>In the left-association <code>(𝑚 &gt;&gt;= f) &gt;&gt;= g</code>, the bracketed part gives the two arguments we need for bind: <code>𝑚 :: m a</code>, and <code>f :: (a -&gt; m b)</code>. Evaluating these gives a new term <code>𝑥 :: m b</code>. This is a monadic object, which is exactly what we expect on the left-hand side of the next bind. Therefore the next step is to apply g to 𝑥, giving a new monadic object, and then we’re done. Easy.</p>
<p>Right-association, on the other hand, is a pain in the ass. Again:</p>
<p><code>𝑚 &gt;&gt;= (\x -&gt; f x &gt;&gt;= g)</code></p>
<p>To understand why we have to write it this monstrous way, let’s see how it would look if we didn’t:</p>
<p><code>a &gt;&gt;= (b &gt;&gt;= c)</code></p>
<p>Here, b is a monadic object, and c is a function. Applying bind to these gives a new monadic object 𝑦. Then the next step is to evaluate <code>a &gt;&gt;= 𝑦</code>.</p>
<p>Here we have a problem, because 𝑦 needs to be both a monadic object (as output of <code>b &gt;&gt;= c</code>) and a function (as input to <code>a &gt;&gt;= 𝑦</code>), which doesn’t really make sense.</p>
<p>To understand right-association (<code>𝑚 &gt;&gt;= (\x -&gt; f x &gt;&gt;= g)</code>), let’s start from the first bind. We know the left-hand side 𝑚 is a monadic object. We also know that the right-hand side needs to be a function, which is satisfied due to the lambda-term (i.e. <code>\x -&gt;</code>).</p>
<p>In evaluating <code>𝑚:: m a</code>, the first bind ‘unwraps’ the 𝑎 from its monadic wrapper, and feeds it to the function on the right-hand side. So this 𝑎 is an ordinary non-monadic object, and we’re using it as an input for our function, which has type <code>(a -&gt; m b)</code>.</p>
<p>But this 𝑎 is precisely the argument x that is called for in the lambda-function \x. Once it gets that argument, we can just ignore the function part (<code>\x -&gt;</code>), and only need to deal with <code>f x &gt;&gt;= g</code>.</p>
<p>Well, f has type <code>(a -&gt; m b)</code>, so it takes this argument 𝑎 (or x) to produce a monadic object m b, which is what we expect on the left-hand side. Then we unwrap the b and pass it to the function g, which is likewise typed <code>(a -&gt; m b)</code> in general, or in this case <code>(b -&gt; m c)</code>. Thus, the end result of this double bind is a monadic object <code>m c</code>. Hooray!</p>
<hr />
<p>To recap: with left-associativity <code>(𝑚 &gt;&gt;= f) &gt;&gt;= g</code>, things are easy because we can simply evaluate the expression in brackets, and then feed the result as an argument to the remaining expression.</p>
<p>With right-associativity <code>𝑚 &gt;&gt;= (\x -&gt; f x &gt;&gt;= g)</code>, we can’t quite do that, because of this pesky \x. Instead, the 𝑎 term from <code>𝑚 :: m a</code> is used as the x argument, and <em>then</em> we can evaluate the bracketed part independently.</p>
<p>I’ve reread the monad laws many times, and this eluded me up until now. This is likely one of those things that will seem ‘obvious’ going forward, but even as I wrote this post I almost lost the main insight, due to a minor confusion about 𝑚. (My mistake was: I briefly thought the first bind passed all of 𝑚 to \x, not just the 𝑎 term.)</p>
<p>Given how garrulous this post was, it’s no wonder most treatments of the monad laws just glance over associativity. The step I was missing was so profoundly simple, but easily lost among the mess of symbols. Therefore I hope this post helps not only ‘advanced beginners’ like myself, but also reminds experienced coders how to think of monads from the ground up.</p>

                <hr>

                <ul class="pager">
                    
                    
                </ul>

            </div>
        </div>
    </div>
</article>
<hr>
    </div>
    <div id="footer">
    </div>
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="https://gjoncas.github.io/rss.xml" data-datatype="json" data-type="GET" data-target="#frame" class="reload" id="clickme">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="https://twitter.com/gjncs" data-datatype="json" data-type="GET" data-target="#frame" class="reload" id="clickme" target="_blank">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://github.com/gjoncas" target="_blank">
                            <span class="fa-stack fa-lg">

                                <i class="fa fa-arrow-circle-o-down"></i>
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://instagram.com/tesseractics" target="_blank">
                            <span class="fa-stack fa-lg">

                                <i class="fa fa-arrow-circle-o-down"></i>
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-instagram fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">All text &copy; Graham Joncas (<a href="https://creativecommons.org/licenses/by/2.5/ca/">CC BY</a>). <br><br>
                </p>
                <div class="col-md-12">
                    <p class="copyright text-muted">
                        site: <a href="https://jaspervdj.be/hakyll">hakyll</a> | 
                        theme: <a href="https://github.com/dindi-jekyll/CleanMagicMedium-Jekyll">lg</a> |
                        code: <a href="https://github.com/katychuang/CleanMagic-hakyll">kc</a> </p>
                </div>



            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="https://gjoncas.github.io/static/js/jquery.min.js"></script>
<script src="https://gjoncas.github.io/static/js/spaceg.stylesheets.min.js"></script>
<script src="https://gjoncas.github.io/static/js/bootstrap.min.js"></script>
<script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
<script src="https://gjoncas.github.io/static/js/scripts.js"></script>

</body>

</html>